![Alt Text](img\Snipaste_2024-10-16_21-57-44.png)

命令字操作：

第一位默认为一1；若为0则禁止对DS1302写入

第二位操作RAM就给1，给0就是操作时钟；

第五位到第一位输入输出到指定寄存器

最后一位读操作就给1，写操作就给0.

- **秒：Bit7表示时钟停止，给1就会停止，Bite~3位存秒，Bite4~6位存十秒**

- 分钟：Bit0~3存分钟，Bit4~7存10分钟

- **小时:**  Bit7表示24小时制与12小时制，若BIT7=0，表示24小时制，而BIT4表示存储10小时，若BIT7=1表示12小时制，BIT4表示是PM还是AM

进制转换

BCD码转十进制：DEC = BCD/16*10+BCD%16;(2位BCD)

十进制转BCD码：BCD = DEC/10*16+ DEC%10;(2位BCD)

![](img\Snipaste_2024-10-16_23-08-28.png)

上升沿将io口的电平写入，下降沿DSl302就会将他的数据输出

即上升沿单片机要向时钟芯片写入数据，下降沿时钟芯片要向单片机写入数据

io口是共用的既可以输出也可以输入

前半段表示要进行的操作（写操作还是读操作，要操作的寄存器地址）

当命令位给1时，DS1302就会将后半数据输出到单片机，当给1的时候就会单片机继续将后半段的数据写入时钟芯片

所有数据传输开始驱动 CE输入高电平，如果 CE输入为低电平,则所有数据传输终止,并且 I/O 口成高阻 抗状态

在上电时, CE必须为逻辑 0直到 VCC 大于 2.0V. 同样,  当 CE 变成逻辑 1状态时CLK 必须为逻辑 0

时钟单字节写流程：

1.把CE置到高电平 --》发命令字（先发【R/W】来确定操作类型，）--》SCLK给一个上升沿来写入单片机 --》 将时钟置回零，即出一个下降沿 --》将下一位数据放到io线上 --》时钟再给一个上升沿来继续写入数据 --》时钟置回零，再出一个下降沿。。。一直循环八次将一个字节的数据写入 --》然后再给一个低电平 即下降沿 --》玩成了命令字的写入操作（告诉单片机在哪读在哪写）

